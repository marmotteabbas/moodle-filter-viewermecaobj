define(["filter_viewermecaobj/three"],function(a){a.OrbitControls=function(b,c){function d(){return 2*Math.PI/60/60*n.autoRotateSpeed}function e(){return Math.pow(.95,n.zoomSpeed)}function f(a){if(n.enabled!==!1){if(a.preventDefault(),0===a.button){if(n.noRotate===!0)return;G=F.ROTATE,p.set(a.clientX,a.clientY)}else if(1===a.button){if(n.noZoom===!0)return;G=F.DOLLY,x.set(a.clientX,a.clientY)}else if(2===a.button){if(n.noPan===!0)return;G=F.PAN,s.set(a.clientX,a.clientY)}n.domElement.addEventListener("mousemove",g,!1),n.domElement.addEventListener("mouseup",h,!1),n.dispatchEvent(I)}}function g(a){if(n.enabled!==!1){a.preventDefault();var b=n.domElement===document?n.domElement.body:n.domElement;if(G===F.ROTATE){if(n.noRotate===!0)return;q.set(a.clientX,a.clientY),r.subVectors(q,p),n.rotateLeft(2*Math.PI*r.x/b.clientWidth*n.rotateSpeed),n.rotateUp(2*Math.PI*r.y/b.clientHeight*n.rotateSpeed),p.copy(q)}else if(G===F.DOLLY){if(n.noZoom===!0)return;y.set(a.clientX,a.clientY),z.subVectors(y,x),z.y>0?n.dollyIn():n.dollyOut(),x.copy(y)}else if(G===F.PAN){if(n.noPan===!0)return;t.set(a.clientX,a.clientY),u.subVectors(t,s),n.pan(u.x,u.y),s.copy(t)}n.update()}}function h(){n.enabled!==!1&&(n.domElement.removeEventListener("mousemove",g,!1),n.domElement.removeEventListener("mouseup",h,!1),n.dispatchEvent(J),G=F.NONE)}function i(a){if(n.enabled!==!1&&n.noZoom!==!0){a.preventDefault();var b=0;void 0!==a.wheelDelta?b=a.wheelDelta:void 0!==a.detail&&(b=-a.detail),b>0?n.dollyOut():n.dollyIn(),n.update(),n.dispatchEvent(I),n.dispatchEvent(J)}}function j(a){if(n.enabled!==!1&&n.noKeys!==!0&&n.noPan!==!0)switch(a.keyCode){case n.keys.UP:n.pan(0,n.keyPanSpeed),n.update();break;case n.keys.BOTTOM:n.pan(0,-n.keyPanSpeed),n.update();break;case n.keys.LEFT:n.pan(n.keyPanSpeed,0),n.update();break;case n.keys.RIGHT:n.pan(-n.keyPanSpeed,0),n.update()}}function k(a){if(n.enabled!==!1){switch(a.touches.length){case 1:if(n.noRotate===!0)return;G=F.TOUCH_ROTATE,p.set(a.touches[0].pageX,a.touches[0].pageY);break;case 2:if(n.noZoom===!0)return;G=F.TOUCH_DOLLY;var b=a.touches[0].pageX-a.touches[1].pageX,c=a.touches[0].pageY-a.touches[1].pageY,d=Math.sqrt(b*b+c*c);x.set(0,d);break;case 3:if(n.noPan===!0)return;G=F.TOUCH_PAN,s.set(a.touches[0].pageX,a.touches[0].pageY);break;default:G=F.NONE}n.dispatchEvent(I)}}function l(a){if(n.enabled!==!1){a.preventDefault(),a.stopPropagation();var b=n.domElement===document?n.domElement.body:n.domElement;switch(a.touches.length){case 1:if(n.noRotate===!0)return;if(G!==F.TOUCH_ROTATE)return;q.set(a.touches[0].pageX,a.touches[0].pageY),r.subVectors(q,p),n.rotateLeft(2*Math.PI*r.x/b.clientWidth*n.rotateSpeed),n.rotateUp(2*Math.PI*r.y/b.clientHeight*n.rotateSpeed),p.copy(q),n.update();break;case 2:if(n.noZoom===!0)return;if(G!==F.TOUCH_DOLLY)return;var c=a.touches[0].pageX-a.touches[1].pageX,d=a.touches[0].pageY-a.touches[1].pageY,e=Math.sqrt(c*c+d*d);y.set(0,e),z.subVectors(y,x),z.y>0?n.dollyOut():n.dollyIn(),x.copy(y),n.update();break;case 3:if(n.noPan===!0)return;if(G!==F.TOUCH_PAN)return;t.set(a.touches[0].pageX,a.touches[0].pageY),u.subVectors(t,s),n.pan(u.x,u.y),s.copy(t),n.update();break;default:G=F.NONE}}}function m(){n.enabled!==!1&&(n.dispatchEvent(J),G=F.NONE)}this.object=b,this.domElement=void 0!==c?c:document,this.enabled=!0,this.target=new a.Vector3,this.center=this.target,this.noZoom=!1,this.zoomSpeed=1,this.minDistance=0,this.maxDistance=1/0,this.noRotate=!1,this.rotateSpeed=1,this.noPan=!1,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.noKeys=!1,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40};var n=this,o=1e-6,p=new a.Vector2,q=new a.Vector2,r=new a.Vector2,s=new a.Vector2,t=new a.Vector2,u=new a.Vector2,v=new a.Vector3,w=new a.Vector3,x=new a.Vector2,y=new a.Vector2,z=new a.Vector2,A=0,B=0,C=1,D=new a.Vector3,E=new a.Vector3,F={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},G=F.NONE;this.target0=this.target.clone(),this.position0=this.object.position.clone();var H={type:"change"},I={type:"start"},J={type:"end"};this.rotateLeft=function(a){void 0===a&&(a=d()),B-=a},this.rotateUp=function(a){void 0===a&&(a=d()),A-=a},this.panLeft=function(a){var b=this.object.matrix.elements;v.set(b[0],b[1],b[2]),v.multiplyScalar(-a),D.add(v)},this.panUp=function(a){var b=this.object.matrix.elements;v.set(b[4],b[5],b[6]),v.multiplyScalar(a),D.add(v)},this.pan=function(a,b){var c=n.domElement===document?n.domElement.body:n.domElement;if(void 0!==n.object.fov){var d=n.object.position,e=d.clone().sub(n.target),f=e.length();f*=Math.tan(n.object.fov/2*Math.PI/180),n.panLeft(2*a*f/c.clientHeight),n.panUp(2*b*f/c.clientHeight)}else void 0!==n.object.top?(n.panLeft(a*(n.object.right-n.object.left)/c.clientWidth),n.panUp(b*(n.object.top-n.object.bottom)/c.clientHeight)):console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled.")},this.dollyIn=function(a){void 0===a&&(a=e()),C/=a},this.dollyOut=function(a){void 0===a&&(a=e()),C*=a},this.update=function(){var a=this.object.position;w.copy(a).sub(this.target);var b=Math.atan2(w.x,w.z),c=Math.atan2(Math.sqrt(w.x*w.x+w.z*w.z),w.y);this.autoRotate&&this.rotateLeft(d()),b+=B,c+=A,c=Math.max(this.minPolarAngle,Math.min(this.maxPolarAngle,c)),c=Math.max(o,Math.min(Math.PI-o,c));var e=w.length()*C;e=Math.max(this.minDistance,Math.min(this.maxDistance,e)),this.target.add(D),w.x=e*Math.sin(c)*Math.sin(b),w.y=e*Math.cos(c),w.z=e*Math.sin(c)*Math.cos(b),a.copy(this.target).add(w),this.object.lookAt(this.target),B=0,A=0,C=1,D.set(0,0,0),E.distanceTo(this.object.position)>0&&(this.dispatchEvent(H),E.copy(this.object.position))},this.reset=function(){G=F.NONE,this.target.copy(this.target0),this.update()},this.domElement.addEventListener("contextmenu",function(a){a.preventDefault()},!1),this.domElement.addEventListener("mousedown",f,!1),this.domElement.addEventListener("mousewheel",i,!1),this.domElement.addEventListener("DOMMouseScroll",i,!1),this.domElement.addEventListener("touchstart",k,!1),this.domElement.addEventListener("touchend",m,!1),this.domElement.addEventListener("touchmove",l,!1),window.addEventListener("keydown",j,!1)},a.OrbitControls.prototype=Object.create(a.EventDispatcher.prototype)});